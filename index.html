<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë°”ì´ëŸ´ ROI ê³„ì‚°ê¸°</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 30px;
        }
        
        .section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            border: 1px solid #e9ecef;
        }
        
        .section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.4rem;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        
        .formula-section {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .formula-section h2 {
            color: white;
            border-bottom-color: rgba(255,255,255,0.3);
        }
        
        .formula {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 14px;
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #34495e;
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        .viral-inputs {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .viral-input {
            text-align: center;
        }
        
        .viral-input label {
            font-size: 12px;
            margin-bottom: 3px;
        }
        
        .viral-input input {
            padding: 8px;
            font-size: 12px;
        }
        
        .button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease;
            width: 100%;
            margin-top: 20px;
        }
        
        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        .results {
            grid-column: 1 / -1;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .metric-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 2px solid #e9ecef;
            transition: transform 0.2s ease;
        }
        
        .metric-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .metric-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .metric-label {
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .positive { color: #27ae60; }
        .negative { color: #e74c3c; }
        .neutral { color: #3498db; }
        
        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border: 2px solid #e9ecef;
        }
        
        .chart-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }
        
        .chart-item {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #e9ecef;
        }
        
        .chart-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .table-container {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: right;
            border-bottom: 1px solid #e9ecef;
        }
        
        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
            text-align: center;
        }
        
        tr:hover {
            background-color: #f8f9fa;
        }
        
        .month-col {
            text-align: left !important;
            font-weight: 600;
        }
        
        @media (max-width: 768px) {
            .content {
                grid-template-columns: 1fr;
            }
            
            .viral-inputs {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .results-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .chart-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ ë°”ì´ëŸ´ ROI ê³„ì‚°ê¸°</h1>
            <p>ì›”ë³„ ë°”ì´ëŸ´ ë¹„ìœ¨ì„ ì¡°ì •í•˜ì—¬ ë§ˆì¼€íŒ… ROIë¥¼ ì‹œë®¬ë ˆì´ì…˜í•˜ì„¸ìš”</p>
        </div>
        
        <div class="content">
            <div class="formula-section">
                <h2>ğŸ“ ë°”ì´ëŸ´ ì„±ì¥ ê³µì‹</h2>
                <div class="formula">
                    <strong>ì§€ìˆ˜ ì„±ì¥:</strong> viral% = start Ã— e^(growth_rate Ã— month)
                </div>
                <div class="formula">
                    <strong>S-Curve:</strong> viral% = max / (1 + e^(-steepness Ã— (month - midpoint)))
                </div>
                <div class="formula">
                    <strong>ì„ í˜• ì„±ì¥:</strong> viral% = start + (growth_per_month Ã— month)
                </div>
                <div class="formula">
                    <strong>ì†ìµ ê³„ì‚°:</strong> ì›”ì†ìµ = (ì´ë°©ë¬¸ì Ã— ë°©ë¬¸ìLTV) - (ìœ ë£Œë°©ë¬¸ì Ã— CPC)
                </div>
            </div>
            
            <div class="section">
                <h2>âš™ï¸ ê¸°ë³¸ ì„¤ì •</h2>
                <div class="input-group">
                    <label>CPC (ì›)</label>
                    <input type="number" id="cpc" value="500">
                </div>
                <div class="input-group">
                    <label>ë°©ë¬¸ì LTV (ì›)</label>
                    <input type="number" id="visitorLTV" value="130">
                </div>
                <div class="input-group">
                    <label>ì„±ì¥ ëª¨ë¸</label>
                    <select id="growthModel">
                        <option value="scurve">S-Curve (í˜„ì‹¤ì )</option>
                        <option value="exponential">ì§€ìˆ˜ ì„±ì¥</option>
                        <option value="linear">ì„ í˜• ì„±ì¥</option>
                        <option value="custom">ì§ì ‘ ì…ë ¥</option>
                    </select>
                </div>
            </div>
            
            <div class="section">
                <h2>ğŸ“ˆ ì„±ì¥ íŒŒë¼ë¯¸í„°</h2>
                <div class="input-group">
                    <label>ì‹œì‘ ë°”ì´ëŸ´% (ì²« ë‹¬)</label>
                    <input type="number" id="startViral" value="0.1" step="0.1">
                </div>
                <div class="input-group">
                    <label>ìµœëŒ€ ë°”ì´ëŸ´% (ëª©í‘œ)</label>
                    <input type="number" id="maxViral" value="90" step="1">
                </div>
                <div class="input-group">
                    <label>ì„±ì¥ ì†ë„ (ê°€íŒŒë¦„ ì •ë„)</label>
                    <input type="number" id="steepness" value="0.8" step="0.1">
                </div>
                <div class="input-group">
                    <label>ë³€ê³¡ì  (ëª‡ ë‹¬ì§¸ ê°€ì†)</label>
                    <input type="number" id="midpoint" value="8">
                </div>
            </div>
            
            <div class="section" id="customSection" style="display: none;">
                <h2>ğŸ¯ ì›”ë³„ ë°”ì´ëŸ´% ì§ì ‘ ì…ë ¥</h2>
                <div class="viral-inputs" id="viralInputs">
                    <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
                </div>
            </div>
            
            <button class="button" onclick="calculate()">ğŸ’« ROI ê³„ì‚°í•˜ê¸°</button>
            
            <div class="section results" id="results" style="display: none;">
                <h2>ğŸ“Š ê³„ì‚° ê²°ê³¼</h2>
                <div class="results-grid">
                    <div class="metric-card">
                        <div class="metric-value neutral" id="breakEvenMonth">-</div>
                        <div class="metric-label">ì›”ë³„ ì†ìµë¶„ê¸°</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value neutral" id="cumulativeBreakEven">-</div>
                        <div class="metric-label">ëˆ„ì  ì†ìµë¶„ê¸°</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="maxLoss">-</div>
                        <div class="metric-label">ìµœëŒ€ ëˆ„ì  ì†ì‹¤</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="finalProfit">-</div>
                        <div class="metric-label">ìµœì¢… ëˆ„ì  ì†ìµ</div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-grid">
                        <div class="chart-item">
                            <div class="chart-title">ğŸ“ˆ ë°”ì´ëŸ´ ì„±ì¥ ì¶”ì´</div>
                            <canvas id="viralChart" width="400" height="200"></canvas>
                        </div>
                        <div class="chart-item">
                            <div class="chart-title">ğŸ’° ì›”ë³„ ì†ìµ</div>
                            <canvas id="profitChart" width="400" height="200"></canvas>
                        </div>
                    </div>
                    <div class="chart-item">
                        <div class="chart-title">ğŸ“Š ëˆ„ì  ì†ìµ ì¶”ì´</div>
                        <canvas id="cumulativeChart" width="800" height="300"></canvas>
                    </div>
                </div>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ì›”</th>
                                <th>ë°©ë¬¸ì</th>
                                <th>ë°”ì´ëŸ´%</th>
                                <th>ìœ ë£Œë°©ë¬¸</th>
                                <th>ìœ ë£Œë¹„ìš©(M)</th>
                                <th>ì›”ì†ìµ(M)</th>
                                <th>ëˆ„ì ì†ìµ(M)</th>
                            </tr>
                        </thead>
                        <tbody id="resultsTable">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        const visitors = [148000, 171750, 250437, 374792, 437818, 609849, 653854, 933535, 1168203, 1829176, 2583565, 2922826, 3672302, 4193519, 4407819, 6490896];
        const months = ["2025-10", "2025-11", "2025-12", "2026-1", "2026-2", "2026-3", "2026-4", "2026-5", "2026-6", "2026-7", "2026-8", "2026-9", "2026-10", "2026-11", "2026-12", "2027-1"];
        
        // ì»¤ìŠ¤í…€ ì…ë ¥ í•„ë“œ ìƒì„±
        function createCustomInputs() {
            const container = document.getElementById('viralInputs');
            container.innerHTML = '';
            
            for (let i = 0; i < 16; i++) {
                const div = document.createElement('div');
                div.className = 'viral-input';
                div.innerHTML = `
                    <label>${months[i]}</label>
                    <input type="number" id="viral_${i}" value="0" step="0.1" min="0" max="100">
                `;
                container.appendChild(div);
            }
        }
        
        // ì„±ì¥ ëª¨ë¸ ë³€ê²½ ì´ë²¤íŠ¸
        document.getElementById('growthModel').addEventListener('change', function() {
            const customSection = document.getElementById('customSection');
            if (this.value === 'custom') {
                customSection.style.display = 'block';
                createCustomInputs();
            } else {
                customSection.style.display = 'none';
            }
        });
        
        // ë°”ì´ëŸ´ ë¹„ìœ¨ ê³„ì‚° í•¨ìˆ˜ë“¤
        function calculateViralRatio(monthIndex, model, params) {
            const { start, max, steepness, midpoint, growthRate } = params;
            
            switch(model) {
                case 'exponential':
                    // ì‹œì‘ì ì—ì„œ ì§€ìˆ˜ì ìœ¼ë¡œ ì„±ì¥
                    const expValue = (start/100) * Math.exp(growthRate * monthIndex);
                    return Math.min(max/100, expValue);
                
                case 'scurve':
                    // ì‹œì‘ì ì„ ë°˜ì˜í•œ S-Curve
                    const range = max - start;
                    const normalized = 1 / (1 + Math.exp(-steepness * (monthIndex - midpoint)));
                    return (start + range * normalized) / 100;
                
                case 'linear':
                    const growthPerMonth = (max - start) / 15; // 16ê°œì›”ì— ê±¸ì³ ì„ í˜• ì„±ì¥
                    return Math.min(max/100, (start + growthPerMonth * monthIndex) / 100);
                
                case 'custom':
                    const input = document.getElementById(`viral_${monthIndex}`);
                    return input ? parseFloat(input.value) / 100 : 0;
                
                default:
                    return 0;
            }
        }
        
        function calculate() {
            const cpc = parseFloat(document.getElementById('cpc').value);
            const visitorLTV = parseFloat(document.getElementById('visitorLTV').value);
            const model = document.getElementById('growthModel').value;
            
            const params = {
                start: parseFloat(document.getElementById('startViral').value),
                max: parseFloat(document.getElementById('maxViral').value),
                steepness: parseFloat(document.getElementById('steepness').value),
                midpoint: parseFloat(document.getElementById('midpoint').value),
                growthRate: 0.3 // ì§€ìˆ˜ ì„±ì¥ë¥ 
            };
            
            let cumulativeLoss = 0;
            let maxLoss = 0;
            let monthlyBreakEven = -1;
            let cumulativeBreakEven = -1;
            
            const results = [];
            
            for (let i = 0; i < 16; i++) {
                const totalVisitors = visitors[i];
                const viralRatio = calculateViralRatio(i, model, params);
                
                const viralVisitors = Math.round(totalVisitors * viralRatio);
                const paidVisitors = totalVisitors - viralVisitors;
                const marketingCost = paidVisitors * cpc;
                
                const totalRevenue = totalVisitors * visitorLTV;
                const monthlyProfit = totalRevenue - marketingCost;
                cumulativeLoss += monthlyProfit;
                
                // ì›”ë³„ ì†ìµë¶„ê¸°ì 
                if (monthlyProfit > 0 && monthlyBreakEven === -1) {
                    monthlyBreakEven = i;
                }
                
                // ëˆ„ì  ì†ìµë¶„ê¸°ì 
                if (cumulativeLoss > 0 && cumulativeBreakEven === -1) {
                    cumulativeBreakEven = i;
                }
                
                // ìµœëŒ€ ì†ì‹¤
                if (cumulativeLoss < maxLoss) {
                    maxLoss = cumulativeLoss;
                }
                
                results.push({
                    month: months[i],
                    visitors: totalVisitors,
                    viralRatio: viralRatio * 100,
                    paidVisitors,
                    marketingCost: marketingCost / 1000000,
                    monthlyProfit: monthlyProfit / 1000000,
                    cumulativeLoss: cumulativeLoss / 1000000
                });
            }
            
            displayResults(results, monthlyBreakEven, cumulativeBreakEven, maxLoss / 1000000, cumulativeLoss / 1000000);
        }
        
        
        // ì°¨íŠ¸ ì¸ìŠ¤í„´ìŠ¤ ì €ì¥
        let viralChart, profitChart, cumulativeChart;
        
        // ì°¨íŠ¸ ìƒì„±/ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateCharts(results) {
            const labels = results.map(r => r.month);
            const viralData = results.map(r => r.viralRatio);
            const profitData = results.map(r => r.monthlyProfit);
            const cumulativeData = results.map(r => r.cumulativeLoss);
            
            // ë°”ì´ëŸ´ ì„±ì¥ ì°¨íŠ¸
            const viralCtx = document.getElementById('viralChart').getContext('2d');
            if (viralChart) viralChart.destroy();
            viralChart = new Chart(viralCtx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'ë°”ì´ëŸ´ ë¹„ìœ¨ (%)',
                        data: viralData,
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        },
                        x: {
                            ticks: {
                                maxRotation: 45
                            }
                        }
                    }
                }
            });
            
            // ì›”ë³„ ì†ìµ ì°¨íŠ¸
            const profitCtx = document.getElementById('profitChart').getContext('2d');
            if (profitChart) profitChart.destroy();
            profitChart = new Chart(profitCtx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'ì›”ë³„ ì†ìµ (Mì›)',
                        data: profitData,
                        backgroundColor: profitData.map(p => p >= 0 ? 'rgba(39, 174, 96, 0.8)' : 'rgba(231, 76, 60, 0.8)'),
                        borderColor: profitData.map(p => p >= 0 ? '#27ae60' : '#e74c3c'),
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            ticks: {
                                callback: function(value) {
                                    return value + 'M';
                                }
                            }
                        },
                        x: {
                            ticks: {
                                maxRotation: 45
                            }
                        }
                    }
                }
            });
            
            // ëˆ„ì  ì†ìµ ì°¨íŠ¸
            const cumulativeCtx = document.getElementById('cumulativeChart').getContext('2d');
            if (cumulativeChart) cumulativeChart.destroy();
            cumulativeChart = new Chart(cumulativeCtx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'ëˆ„ì  ì†ìµ (Mì›)',
                        data: cumulativeData,
                        borderColor: '#764ba2',
                        backgroundColor: 'rgba(118, 75, 162, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            ticks: {
                                callback: function(value) {
                                    return value + 'M';
                                }
                            }
                        },
                        x: {
                            ticks: {
                                maxRotation: 45
                            }
                        }
                    }
                }
            });
        }
        
        function displayResults(results, monthlyBE, cumulativeBE, maxLoss, finalProfit) {
            // ìš”ì•½ ë©”íŠ¸ë¦­ ì—…ë°ì´íŠ¸
            document.getElementById('breakEvenMonth').textContent = monthlyBE >= 0 ? months[monthlyBE] : 'ë¯¸ë‹¬ì„±';
            document.getElementById('cumulativeBreakEven').textContent = cumulativeBE >= 0 ? months[cumulativeBE] : 'ë¯¸ë‹¬ì„±';
            
            const maxLossEl = document.getElementById('maxLoss');
            maxLossEl.textContent = maxLoss.toFixed(1) + 'M';
            maxLossEl.className = 'metric-value ' + (maxLoss < 0 ? 'negative' : 'positive');
            
            const finalProfitEl = document.getElementById('finalProfit');
            finalProfitEl.textContent = finalProfit.toFixed(1) + 'M';
            finalProfitEl.className = 'metric-value ' + (finalProfit < 0 ? 'negative' : 'positive');
            
            // í…Œì´ë¸” ì—…ë°ì´íŠ¸
            const tbody = document.getElementById('resultsTable');
            tbody.innerHTML = '';
            
            results.forEach(row => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td class="month-col">${row.month}</td>
                    <td>${row.visitors.toLocaleString()}</td>
                    <td>${row.viralRatio.toFixed(1)}%</td>
                    <td>${row.paidVisitors.toLocaleString()}</td>
                    <td>${row.marketingCost.toFixed(1)}</td>
                    <td class="${row.monthlyProfit >= 0 ? 'positive' : 'negative'}">${row.monthlyProfit.toFixed(1)}</td>
                    <td class="${row.cumulativeLoss >= 0 ? 'positive' : 'negative'}">${row.cumulativeLoss.toFixed(1)}</td>
                `;
                tbody.appendChild(tr);
            });
            
            // ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            updateCharts(results);
            
            document.getElementById('results').style.display = 'block';
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }
        
        // ì´ˆê¸° ê³„ì‚°
        calculate();
    </script>
</body>
</html>
